calculate_anglo_french_passive_progress = {
	set_global_variable = { name = french_influence_passive_var value = 0 }
	set_global_variable = { name = british_influence_passive_var value = 0 }
	set_global_variable = { name = anglo_french_balance_passive_var value = 0 }
	set_global_variable = { name = england_france_gdp value = 0 }
	
	c:GBR ?= {
		every_state = {
			limit = {
				OR = {
					region = sr:region_england
					region = sr:region_france
				}
			}
		change_global_variable = { name = england_france_gdp add = this.gdp }
		}

	}

	change_global_variable = { name = england_france_gdp divide = 1000 }

	c:GBR ?= {
		every_scope_state = {
			limit = {
				region = sr:region_england
			}
			change_global_variable = { name = british_influence_passive_var add = this.gdp }
		}
		change_global_variable = { name = british_influence_passive_var divide = 100 }
		change_global_variable = { name = british_influence_passive_var divide = global_var:england_france_gdp }

		every_scope_state = {
			limit = {
				region = sr:region_france
			}
			change_global_variable = { name = french_influence_passive_var add = this.gdp }
		}
		change_global_variable = { name = french_influence_passive_var divide = 100 }
		change_global_variable = { name = french_influence_passive_var divide = global_var:england_france_gdp }
	}

	set_global_variable = { name = anglo_french_balance_passive_var value = global_var:french_influence_passive_var }
	change_global_variable = { name = anglo_french_balance_passive_var subtract = global_var:british_influence_passive_var }
	change_global_variable = { name = anglo_french_balance_passive_var multiply = 3 }
}

calculate_anglo_french_ig_progress = {
	set_global_variable = { name = anglo_french_balance_ig_var value = 0 }
		every_interest_group = {
			if = {
	 			limit = {
	 				is_in_government = yes
	 				has_variable = english_var
	 			}
	 		change_global_variable = { name = anglo_french_balance_ig_var add = 1}
	 		}
	 		if = {
	 			limit = {
	 				is_in_government = yes
	 				has_variable = french_var
	 			}
	 		change_global_variable = { name = anglo_french_balance_ig_var subtract = 1}
	 	}
		}
}

calculate_anglo_french_radical_progress = {
	set_global_variable = { name = anglo_french_balance_radical_var value = 0}
		c:GBR = {
			# ENGLISH RADICALS
			if = {
				limit = {
					radical_fraction = {value >= 0.3 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 3}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.2 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 2}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.1 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 1}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.05 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 0.5}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.025 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 0.25}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.01 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 0.1}
			}
			# FRENCH RADICALS
			if = {
				limit = {
					radical_fraction = {value >= 0.3 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 3}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.2 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 2}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.1 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 1}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.05 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 0.5}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.025 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 0.25}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.01 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 0.1}
			}

		}
}

calculate_anglo_french_event_progress = {
	set_global_variable = { name = anglo_french_balance_event_var }

	change_global_variable = { name = anglo_french_balance_ig_var value = 0}
}

update_anglo_french_progressbar_tooltips = {
	je:je_hpx_anglo_french_influence = {
		if = {
			limit = {
				"scripted_bar_progress(french_english_progress_bar)" < 0
			}
			set_bar_progress = { value = 0 name = french_english_progress_bar }
		}
		if = {
			limit = {
				"scripted_bar_progress(french_english_progress_bar)" > 200
			}
			set_bar_progress = { value = 200 name = french_english_progress_bar }
		}
		set_global_variable = { name = anglo_influence_progress value = "scripted_bar_progress(french_english_progress_bar)" }
		set_global_variable = { name = french_influence_progress value = 200 }
		change_global_variable = { name = french_influence_progress subtract = global_var:anglo_influence_progress }
	}
}

calculate_anglo_french_events = {
	if = {
		limit = {global_var:anglo_influence_progress <= 75}
		trigger_event = hpx_GBR_event.6
	}
	if = {
		limit = {global_var:anglo_influence_progress <= 50}
		trigger_event = hpx_GBR_event.8
	}
	if = {
		limit = {global_var:french_influence_progress <= 50}
		trigger_event = hpx_GBR_event.7
	}
}


setup_space_race_lists = {

	add_to_global_variable_list = {name = unmanned_moon target = c:GBR}
	add_to_global_variable_list = {name = unmanned_moon target = c:USA}
	add_to_global_variable_list = {name = unmanned_moon target = c:RUS}
	add_to_global_variable_list = {name = manned_moon target = c:USA}

}