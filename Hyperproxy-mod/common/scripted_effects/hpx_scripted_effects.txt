calculate_anglo_french_passive_progress = {
	set_global_variable = { name = french_influence_passive_var value = 0 }
	set_global_variable = { name = british_influence_passive_var value = 0 }
	set_global_variable = { name = anglo_french_balance_passive_var value = 0 }
	set_global_variable = { name = england_france_gdp value = 0 }
	
	c:GBR ?= {
		every_state = {
			limit = {
				OR = {
					region = sr:region_england
					region = sr:region_france
				}
			}
		change_global_variable = { name = england_france_gdp add = this.gdp }
		}

	}

	change_global_variable = { name = england_france_gdp divide = 1000 }

	c:GBR ?= {
		every_scope_state = {
			limit = {
				region = sr:region_england
			}
			change_global_variable = { name = british_influence_passive_var add = this.gdp }
		}
		change_global_variable = { name = british_influence_passive_var divide = 100 }
		change_global_variable = { name = british_influence_passive_var divide = global_var:england_france_gdp }

		every_scope_state = {
			limit = {
				region = sr:region_france
			}
			change_global_variable = { name = french_influence_passive_var add = this.gdp }
		}
		change_global_variable = { name = french_influence_passive_var divide = 100 }
		change_global_variable = { name = french_influence_passive_var divide = global_var:england_france_gdp }
	}

	set_global_variable = { name = anglo_french_balance_passive_var value = global_var:french_influence_passive_var }
	change_global_variable = { name = anglo_french_balance_passive_var subtract = global_var:british_influence_passive_var }
	change_global_variable = { name = anglo_french_balance_passive_var multiply = 3 }
}

calculate_anglo_french_ig_progress = {
	set_global_variable = { name = anglo_french_balance_ig_var value = 0 }
		every_interest_group = {
			if = {
	 			limit = {
	 				is_in_government = yes
	 				has_variable = english_var
	 			}
	 		change_global_variable = { name = anglo_french_balance_ig_var add = 1}
	 		}
	 		if = {
	 			limit = {
	 				is_in_government = yes
	 				has_variable = french_var
	 			}
	 		change_global_variable = { name = anglo_french_balance_ig_var subtract = 1}
	 	}
		}
}

calculate_anglo_french_radical_progress = {
	set_global_variable = { name = anglo_french_balance_radical_var value = 0}
		c:GBR = {
			# ENGLISH RADICALS
			if = {
				limit = {
					radical_fraction = {value >= 0.3 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 3}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.2 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 2}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.1 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 1}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.05 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 0.5}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.025 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 0.25}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.01 culture = cu:british}
				}
				change_global_variable = { name = anglo_french_balance_radical_var subtract = 0.1}
			}
			# FRENCH RADICALS
			if = {
				limit = {
					radical_fraction = {value >= 0.3 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 3}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.2 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 2}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.1 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 1}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.05 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 0.5}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.025 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 0.25}
			}
			else_if = {
				limit = {
					radical_fraction = {value >= 0.01 culture = cu:french}
				}
				change_global_variable = { name = anglo_french_balance_radical_var add = 0.1}
			}

		}
}

calculate_anglo_french_event_progress = {
	set_global_variable = { name = anglo_french_balance_event_var }

	change_global_variable = { name = anglo_french_balance_ig_var value = 0}
}

update_anglo_french_progressbar_tooltips = {
	je:je_hpx_anglo_french_influence = {
		if = {
			limit = {
				"scripted_bar_progress(french_english_progress_bar)" < 0
			}
			set_bar_progress = { value = 0 name = french_english_progress_bar }
		}
		if = {
			limit = {
				"scripted_bar_progress(french_english_progress_bar)" > 200
			}
			set_bar_progress = { value = 200 name = french_english_progress_bar }
		}
		set_global_variable = { name = anglo_influence_progress value = "scripted_bar_progress(french_english_progress_bar)" }
		set_global_variable = { name = french_influence_progress value = 200 }
		change_global_variable = { name = french_influence_progress subtract = global_var:anglo_influence_progress }
	}
}

calculate_anglo_french_events = {
	if = {
		limit = {global_var:anglo_influence_progress <= 75}
		trigger_event = hpx_GBR_event.6
	}
	if = {
		limit = {global_var:anglo_influence_progress <= 50}
		trigger_event = hpx_GBR_event.8
	} 
	if = {
		limit = {global_var:french_influence_progress <= 50}
		trigger_event = hpx_GBR_event.7
	}
}


setup_space_race_lists = {

	add_to_global_variable_list = {name = unmanned_moon target = c:GBR}
	add_to_global_variable_list = {name = unmanned_moon target = c:USA}
	add_to_global_variable_list = {name = unmanned_moon target = c:RUS}
	add_to_global_variable_list = {name = manned_moon target = c:USA}

}

dissolve_soviet = {
	create_country = {
		tag = CRI
		state = s:STATE_CRIMEA.region_state:RUS
	}

	create_country = {
		tag = LIT
		state = s:STATE_VILNIUS.region_state:RUS
		state = s:STATE_KAUNAS.region_state:RUS
	}

	create_country = {
		tag = PRU
		state = s:STATE_EAST_PRUSSIA.region_state:RUS
	}

	create_country = {
		tag = LAT
		state = s:STATE_RIGA.region_state:RUS
		state = s:STATE_COURLAND.region_state:RUS
	}
	create_country = {
		tag = EST
		state = s:STATE_TALINN.region_state:RUS
		state = s:STATE_TARTU.region_state:RUS
	}
	create_country = {
		tag = BYE
		state = s:STATE_MINSK.region_state:RUS
		state = s:STATE_BREST.region_state:RUS
		state = s:STATE_MOGILEV.region_state:RUS
		state = s:STATE_VITEBSK.region_state:RUS
	}
	create_country = {
		tag = MOL
		state = s:STATE_MOLDAVIA.region_state:RUS
		state = s:STATE_DOBRUDJA.region_state:RUS
		state = s:STATE_BESSARABIA.region_state:RUS
	}
	create_country = {
		tag = UKR
		state = s:STATE_KIEV.region_state:RUS
		state = s:STATE_VOLHYNIA.region_state:RUS
		state = s:STATE_EAST_GALICIA.region_state:RUS
		state = s:STATE_CHERSON.region_state:RUS
		state = s:STATE_KHARKOV.region_state:RUS
		state = s:STATE_CHERNIHIV.region_state:RUS
		state = s:STATE_TAURIDA.region_state:RUS
	}

	create_country = {
		tag = GEO
		state = s:STATE_GREATER_CAUCASUS.region_state:RUS
	}

	create_country = {
		tag = ARM
		state = s:STATE_ARMENIA.region_state:RUS
	}

	create_country = {
		tag = AZB
		state = s:STATE_AZERBAIJAN.region_state:RUS
	}

	create_country = {
		tag = TRC
		state = s:STATE_TURKMENIA.region_state:RUS
		state = s:STATE_MERZ.region_state:RUS
		state = s:STATE_KHORASAN.region_state:RUS
		state = s:STATE_MAZANDARAN.region_state:RUS
	}

	create_country = {
		tag = UZB
		state = s:STATE_UZBEKIA.region_state:RUS
		state = s:STATE_KHIVA.region_state:RUS
		state = s:STATE_TURKMENIA.region_state:RUS
	}

	create_country = {
		tag = TJI
		state = s:STATE_TAJIKISTAN.region_state:RUS
		state = s:STATE_FERGANA.region_state:RUS
	}

	create_country = {
		tag = KYR
		state = s:STATE_KIRGHIZIA.region_state:RUS
	}

	create_country = {
		tag = KZH
		state = s:STATE_URALSK.region_state:RUS
		state = s:STATE_AKTOBE.region_state:RUS
		state = s:STATE_AKMOLINSK.region_state:RUS
		state = s:STATE_SYRDARYA.region_state:RUS
		state = s:STATE_SEMIRECHE.region_state:RUS
		state = s:STATE_JETISY.region_state:RUS

	}

	create_country = {
		tag = YAK
		state = s:STATE_YAKUTSK.region_state:RUS
		state = s:STATE_KOLYMA.region_state:RUS
	}

	create_country = {
		tag = IKK
		state = s:STATE_IRKUTSK.region_state:RUS
		state = s:STATE_KRASNOYARSK.region_state:RUS
	}

	create_country = {
		tag = RFA
		state = s:STATE_CHUKOTKA.region_state:RUS
		state = s:STATE_KAMCHATKA.region_state:RUS
		state = s:STATE_OKHOTSK.region_state:RUS
		state = s:STATE_SAKHALIN.region_state:RUS
		state = s:STATE_AMUR.region_state:RUS
		state = s:STATE_OUTER_MANCHURIA.region_state:RUS

	}
	
	remove_diplomatic_pact = {
 		country = c:FIN
		type = puppet
	}

	set_global_variable = {
		name = soviet_collapse
		value = 1
	}

	activate_law = law_type:law_presidential_republic
}